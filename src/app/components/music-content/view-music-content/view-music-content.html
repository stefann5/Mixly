<div class="p-4">
  <!-- Header -->
  <div class="flex justify-content-between align-items-center mb-4">
    <h1 class="text-3xl font-bold m-0">Music Content</h1>
    <p-button
      label="Create Song"
      icon="pi pi-plus"
      *ngIf="isAdmin()"
      (onClick)="navigateToCreate()"
    ></p-button>
  </div>

  <!-- Loading State -->
  <div
    class="flex justify-content-center align-items-center"
    style="min-height: 200px"
    *ngIf="isLoading && musicContent.length === 0"
  >
    <p-progressSpinner strokeWidth="3"></p-progressSpinner>
  </div>

  <!-- Error State -->
  <p-message
    *ngIf="errorMessage && !isLoading"
    severity="error"
    [text]="errorMessage"
    styleClass="w-full mb-4"
  ></p-message>

  <!-- Empty State -->
  <p-card
    *ngIf="!isLoading && musicContent.length === 0 && !errorMessage"
    styleClass="text-center"
  >
    <i class="pi pi-users text-6xl text-300 mb-3 block"></i>
    <h3 class="text-xl mb-2">No Music Content Found</h3>
    <p class="text-500 mb-4">No songs have been added yet.</p>
    <p-button
      label="Create First Music Content"
      icon="pi pi-plus"
      (onClick)="navigateToCreate()"
    ></p-button>
  </p-card>

  <!-- Music Contents Grid -->
  <div class="grid" *ngIf="!isLoading && musicContent.length > 0">
    <div
      class="col-12 md:col-6 lg:col-4 xl:col-3"
      *ngFor="let content of musicContent"
    >
      <p-card
        styleClass="h-full shadow-2 hover:shadow-4 transition-all transition-duration-200"
      >
      <div class="text-center mb-3 relative">
        <img [src]="getCoverImageUrl(content)"
             [alt]="content.title + ' cover'"
             class="w-full h-12rem object-fit-cover border-round"/>
        <div class="absolute inset-0 flex align-items-center justify-content-center bg-black-alpha-50 opacity-0 hover:opacity-100 trasition-all transition-duration-200 border-round">
            <p-button [icon]="isCurrentlyPlaying(content.contentId) ? 'pi pi-pause' : 'pi pi-play'"
                      severity="contrast"
                      [rounded]="true"
                      size="large"
                      (onClick)="togglePlayback(content)">
            </p-button>
        </div>
      </div>
        <!-- Song Name -->
        <h3 class="text-xl font-bold text-center mb-3 text-900">
          {{ content.title }}
        </h3>

        <!-- Artist & Album -->
        <div class="text-center mb-3 text-600">
          <div *ngIf="content.artistName" class="mb-1">
            <i class="pi pi-user mr-1"></i>
            {{ content.artistName }}
          </div>
          <div>
            <i class="pi pi-disc mr-1"></i>
            {{ getAlbum(content) }}
          </div>
        </div>

        <!-- Genre using Chips -->
        <h5 class="mb-4">
          {{content.genre}}
        </h5>

        <p-divider></p-divider>

        <!-- Actions -->
        <div class="flex gap-2 justify-content-center mt-3">
          <p-button
            [icon]="isCurrentlyPlaying(content.contentId) ? 'pi pi-pause' : 'pi pi-play'"
            [severity]="isCurrentlyPlaying(content.contentId) ? 'danger' : 'success'"
            size="small"
            (onClick)="togglePlayback(content)"
            [pTooltip]="isCurrentlyPlaying(content.contentId) ? 'Pause' : 'Play'"
            tooltipPosition="top"
          ></p-button>
          <p-button
            icon="pi pi-info-circle"
            severity="info"
            size="small"
            (onClick)="viewSongDetails(content)"
            pTooltip="View Details"
            tooltipPosition="top"></p-button>
          <p-button
            icon="pi pi-pencil"
            severity="danger"
            size="small"
            (onClick)="editSong(content)"
            *ngIf="isAdmin()"
            pTooltip="Edit Song"
            tooltipPosition="top"
          ></p-button>

          <p-button
            icon="pi pi-trash"
            severity="danger"
            size="small"
            (onClick)="deleteSong(content)"
            *ngIf="isAdmin()"
            pTooltip="Delete Song"
            tooltipPosition="top"
          ></p-button>
        </div>
      </p-card>
    </div>
  </div>

  <!-- Load More Button -->
  <div class="text-center mt-4" *ngIf="hasMore && !isLoading">
    <p-button
      label="Load More Songs"
      icon="pi pi-chevron-down"
      severity="secondary"
      (onClick)="loadMoreMusicContent()"
      [loading]="isLoadingMore"
    ></p-button>
  </div>
</div>
<p-dialog
    header="Song Details"
    [(visible)]="displayDialog"
    [modal]="true"
    [style]="{ width: '50vw', minWidth: '300px' }"
    [draggable]="false"
    [resizable]="false">
    <div *ngIf="selectedContent" class="flex flex-column gap-3">
        <div class="flex gap-3 align-items-start">
            <img [src]="getCoverImageUrl(selectedContent)"
                 [alt]="selectedContent.title + ' cover'"
                 class="w-8rem h-8rem object-fit-cover border-round flex-shrink-0"/>
            <div class="flex-1">
                <h2 class="text-2xl font-bold mb-2 text-900">{{ selectedContent.title }}</h2>
                <div class="mb-2"><strong>Artist</strong> {{selectedContent.artistName}}</div>
            </div>
            <div class="mb-2"><strong>Album: </strong> {{getAlbum(selectedContent)}}</div>
            <div class="mb-2"><strong>Genre: </strong> {{selectedContent.genre}}</div>
        </div>

        <p-divider></p-divider>
        <div class="text-center">
        <p-button
            [label]="isCurrentlyPlaying(selectedContent.contentId) ? 'Pause' : 'Play Song'"
            [icon]="isCurrentlyPlaying(selectedContent.contentId) ? 'pi pi-pause' : 'pi pi-play'"
            [severity]="isCurrentlyPlaying(selectedContent.contentId) ? 'danger' : 'success'"
            (onClick)="togglePlayback(selectedContent)"
            size="large"
        ></p-button>
        </div>
    </div>

</p-dialog>
<p-toast></p-toast>